!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var o in r)("object"==typeof exports?exports:e)[o]=r[o]}}(this,(function(){return function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var r={},o={};AFRAME.registerComponent("gltf-part-plus",{schema:{buffer:{default:!0},part:{type:"string"},src:{type:"asset"},resetPosition:{default:!1}},init:function(){this.dracoLoader=document.querySelector("a-scene").systems["gltf-model"].getDRACOLoader()},update:function(){var e=this.el,t=this.data;!this.data.part&&this.data.src||this.getModel((function(r){r&&(t.resetPosition&&(e.setAttribute("position",r.position.x+" "+r.position.y+" "+r.position.z),r.position.set(0,0,0)),e.setObject3D("mesh",r),e.emit("model-loaded",{format:"gltf",part:this.modelPart}))}))},getModel:function(e){var t=this;if(!o[this.data.src])return r[this.data.src]?r[this.data.src].then((function(r){e(t.selectFromModel(r))})):void(r[this.data.src]=new Promise((function(n){var i=new THREE.GLTFLoader;t.dracoLoader&&i.setDRACOLoader(t.dracoLoader),i.load(t.data.src,(function(i){var a=i.scene||i.scenes[0];o[t.data.src]=a,delete r[t.data.src],e(t.selectFromModel(a)),n(a)}),(function(){}),console.error)})));e(this.selectFromModel(o[this.data.src]))},selectFromModel:function(e){var t;if(t=e.getObjectByName(this.data.part))return t;console.error("[gltf-part] `"+this.data.part+"` not found in model.")}}),AFRAME.registerComponent("model-center",{schema:{bottomAlign:{default:!1}},init:function(){this.el.addEventListener("model-loaded",e=>{var t=this.el.getObject3D("mesh");if(t.position.set(0,0,0),t.geometry.center(),this.data.bottomAlign){var r=(new THREE.Box3).setFromObject(t),o=r.max.sub(r.min).y;t.position.y=o/2}})}}),AFRAME.registerComponent("anisotropy",{schema:{default:0},dependencies:["material","geometry"],init:function(){this.maxAnisotropy=this.el.sceneEl.renderer.capabilities.getMaxAnisotropy(),["model-loaded","materialtextureloaded"].forEach(e=>this.el.addEventListener(e,()=>{const e=this.el.getObject3D("mesh");var t=this.data;0===(t=+t||0)&&(t=this.maxAnisotropy),e.traverse(e=>{!0===e.isMesh&&null!==e.material.map&&(e.material.map.anisotropy=t,e.material.map.needsUpdate=!0)})},!1))}}),AFRAME.registerComponent("instancedmesh",{schema:{retainParent:{default:!1},retainChildren:{default:!1},inheritMat:{default:!0},mergeInstances:{default:!1},frustumCulled:{default:!0}},init:function(){},update:function(){var e,t,r,o,n=this.el,i=this.el.children,a=0,s=(e=new THREE.Vector3,t=new THREE.Euler,r=new THREE.Vector3,o=new THREE.Quaternion,function(i,a){e.x=n.children[i].object3D.position.x,e.y=n.children[i].object3D.position.y,e.z=n.children[i].object3D.position.z,t.x=n.children[i].object3D.rotation.x,t.y=n.children[i].object3D.rotation.y,t.z=n.children[i].object3D.rotation.z,o.setFromEuler(t),r.x=n.children[i].object3D.scale.x,r.y=n.children[i].object3D.scale.y,r.z=n.children[i].object3D.scale.z,a.compose(e,o,r)});for(var l of i)a+=1;var d=this.el.getObject3D("mesh");if(d){var c=d.material.clone(),u=null;d.traverse((function(e){!0===e.isMesh&&(u=e.geometry)}));for(var f=new THREE.InstancedMesh(u,c,a),m=0;m<a;m++){var h=new THREE.Matrix4;s(m,h),f.setMatrixAt(m,h)}f.frustumCulled=this.data.frustumCulled,this.el.object3D.add(f),this.data.retainParent||this.el.object3D.remove(d),this.data.inheritMat&&(this.el.components.material.material=c)}else this.el.addEventListener("model-loaded",e=>{this.update(this.data)})}})}])}));